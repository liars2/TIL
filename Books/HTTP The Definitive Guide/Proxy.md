프락시
====================

    웹 프록시 서버는 중개자다.
    프락시는 클라이언트와 서버 사이에 위치하여 그들 사이의 HTTP 메시지를 정리하는 중개인처럼 동작한다.

HTTP 프락시는 웹 서버이기도 하고 웹 클라이언트이기도 하다.
---------------------------------
    웹 프락시 서버는 클라이언트의 입장에서 트랜잭션을 수행하는 중개인이다.
    프락시가 없다면, 클라이언트는 HTTP 서버와 직접 이야기한다
> 하지만 웹 프락시가 있다면, 클라이언트는 HTTP 서버와 이야기하는 대신, 자신의 입장에서 서버와 대화해주는 프락시와 이야기한다.

프락시는 클라이언트의 요청을 받게 되므로, 반드시 웹 서버처럼 요청과 커넥션을 적절히 다루고 응답을 돌려줘야 한다.</br>
동시에 프락시는 요청을 서버로 보내기도 하므로, 요청을 보내고 응답을 받는 올바른 HTTP 클라이언트처럼 동작해야 한다.

**만약 직접 HTTP 프락시를 만든다면, HTTP 클라이언트와 HTTP 서버의 양쪽규칙 모두를 주의 깊게 따라야 한다.**

### 프락시 VS 게이트웨이
    가장 큰 건, 프락시는 같은 프로토콜을 사용하는 둘 이상의 애플리케이션을 연결하고,
    게이트웨이는 서로 다른 프로토콜을 사용하는 둘 이상을 연결한다.

> 게이트웨이는 클라이언트와 서버가 서로 다른 프로토콜로 말하더라도 서로 간의 트랜잭션을 완료할 수 있도록 해주는 프로토콜 변환기처럼 동작한다.

#### 그래서?
    실질적으로 프락시와 게이트웨이의 차이점은 모호하다.
> 브라우저와 서버는 다른 버전의 HTTP를 구현하기 때문에, 프락시는 때때로 약간의 프로토콜 변환을 하기도 한다.

**그리고 사용 프락시 서버는 SSL, SOCKS FIREWALL, FTP 접근 WEB기반 APPLICATION을 지원하기 위해 게이트웨이 기능을 구현한다.**

### 왜 프락시를 사용하는가?
    프락시 서버는 실용적이고 유용한 것이라면 무슨 일이든 한다.
**보안 개선, 성능 향상, 비용 절약 등 이점이 있다.**

### 프락시의 잘 알려진 기능
    프락시는 모든 HTTP 트래픽을 들여다보고 건드릴 수 있기 때문에,
    부가적인 가치를 주는 여러 유용한 웹 서비스를 구현하기 위해 트래픽을 감시하고 수정할 수 있다.


#### 어린이 필터
<img src="../Image/child-safe Internet filter.png">

    부적절한 사이트 거부

#### 문서 접근 제어자
    프락시 서버는 많은 웹 서버들과 웹 리소스에 대한 단일한 접근 제어 전략을 구현하고 감사 추적을 하기 위해 사용될 수 있다.

> 각기 다른 조직에서 관리되는 다양한 종류의 수많은 웹 서버들에 대한 접근 제어를 수시로 갱신할 필요 없이,<br> **중앙 프락시 서버에서 접근 제어를 설정할 수 있다.**

<img src="../Image/centralized document access control.png">
> 중앙화된 문서 접근 제어

#### 보안 방화벽
    프락시 서버는 조직 안에 들어오거나 나가는 응용 레벨 프로토콜의 흐름을 네트워크의 한 지점에서 통제한다.
    또 바이러스를 제거하는 웹이나 이메일 프락시가 사용할 수 있는, 트래픽을 세심히 살펴볼 수 있는 후크(hook)를 제공한다.
<img src="../Image/security firewall.png">

#### 웹 캐시
    인기 많은 문서의 로컬 사본을 관리하고 해당 문서에 대한 요청이 오면 빠르게 제공하여, 느리고 비싼 인터넷 커뮤니케이션을 줄인다.
<img src="../Image/web cache.png">

#### 대리 프락시
    공용 콘텐츠에 대한 느린 웹 서버의 성능을 개선하기 위해 사용할 수 있다.
    보통 사진과 같이 사용되는 프락시를 흔히 서버 가속기라고 부른다.

> 대리 프락시는 또한 콘텐츠 라우팅 기능과 결합되어 주문형 복제 콘텐츠의 분산 네트워크를 만들기 위해 사용될 수 있다.
<img src="../Image/surrogate.png">

#### 콘텐츠 라우터
    프락시 서버는 인터넷 트래픽 조건과 콘텐츠의 종류에 따라 요청을 특정 웹 서버로 유도하는 콘텐츠 라우터로 동작할 수 있다.
    사용자들에게 제공할 여러 서비스를 구현하는데 사용할 수 있다.

<img src="../Image/content routing.png">

#### 트랜스코더
    프락시 서버는 콘텐츠를 클라이언트에게 전달하기 전에 본문 포맷을 수정할 수 있다.
**GIF 이미지를 JPG로 변환, 혹은 이미지 크기를 줄이는 작업 심지어 외국어 문서로 변환 한다.**
> 데이터의 표현 방식을 자연스럽게 변환하는 것을 트랜스코딩이라고 부른다.

<img src="../Image/content transcoder.png">

#### 익명화 프락시
    HTTP 메시지에서 신원을 식별할 수 있는 특성들
    (IP, From Header, Referer Header, Cookies, URI Session Ids)
    제거함으로써 개인 정보 보호와 익명성 보장에 기여한다.

프락시는 어디에 있는가?
---------------------
### 네트워크에 프락시가 배치할 수 있는 다양한 방식
    어떻게 사용할지에 따라서 프락시는 어디에든 배치가 가능하다.

#### 출구 프락시
    로컬과 인터넷 사이를 오가는 트래픽을 제어하기 위해 출구에 프락시를 놓을 수 있음
> 방화벽 제공, 트래픽 개선, 필터링 기능을 사용할 수 있다.

#### 입구 프락시
    고객으로 부터의 모든 요청을 종합적으로 처리하기 위해서 ISP 접근 지점에 놓을 수 있음
> 사용자들의 다운로드 속도 증가, 인터넷 대역폭 비용 감소 목적으로 문서들의 사본 저장

#### 대리 프락시
    네트워크의 가장 끝에 있는 웹 서버들의 바로 앞에 위치하여 웹 서버로 향하는 모든 요청을 처리하고 필요할 때만
    웹 서버들의 바로 웹 서버에게 자원을 요청할 수 있다.
> 웹 서버의 보안 기능 가능 및 느린 웹 서버의 성능 개선
**대리 프락시는 일반적으로 웹 서버의 이름과 IP 주소로 스스로를 가장하기 때문에, 모든 요청은 서버가 아닌 이 프락시로 간다**

#### 네트워크 교환 프락시
    캐시를 이용해 인터넷 교차로의 혼잡을 완화하고 트래픽 흐름을 감시하기 위해,
    충분한 처리 능력을 갖춘 프락시가 네트워크 사이의 인터넷 피어링 교환 지점들에 놓일 수 있다.

<img src="../Image/Proxies can be deployed many ways.png">

### 프락시 계층
<img src="../Image/Proxy layer.png">
    프락시들은 프락시 계층이라고 불리는 연쇄를 구성할 수 있다.
> 프락시 계층에서, 메시지는 최종적으로 원 서버에 도착할 때 까지 프락시와 프락시를 거쳐 이동한다.

**프락시 계층에서 프락시 서버들은 부모와 자식의 관계를 갖는다.**
    다음번 인바운드 프락시(서버에 가까운 쪽)를 부모라고 부르고 다음번 아웃바운드 프락시(클라이언트 가까운 쪽)는 자식이라고 부른다.
> 따라서, 프락시 2는 프락시 3의 자식프락시이며, 프락시 3은 프락시 2의 부모 프락시이다.

#### 프락시 계층 콘텐츠 라우팅
    위 그림의 프락시 계층은 정적이다.
    프락시 1은 언제나 메시지를 프락시 2로 보내고, 프락시 2는 언제나 메시지를 프락시 3으로 보낸다.
> 그러나 계층이 반드시 정적이어야 하는 것은 아니다.

**프락시 서버는 여러 가지 판단 근거에 의해 메시지를 유동적인 프락시 서버와 원 서버들의 집합에게 보낼 수 있다.**

예를들어 밑에 있는 그림, 접근 프락시는 상황에 맞게 부모 프락시나 원 서버에게 라우팅한다.
<img src="../Image/dynamic proxy routing.png">  

- 요청된 객체가 돈을 지불한 웹 서버에 속한 경우, 가까운 캐시 서버에 보내 반환하거나 그럴 수 없을 떄는 서버에서 가져오게 할 수 있다.
- 요청이 특정 종류의 이미지에 대한 것인 경우, 접근 프락시는 그 요청을 특화된 압축 프락시에게 보내어</br>그 프락시가 이미지를 가져와 압축하게 하여 느린 모뎀으로 접속했더라도 빠르게 클라이언트가 다운로드할 수 있게 한다.
### 어떻게 프락시가 트래픽을 처리하는가
    클라이언트는 보통 웹 서버와 직접 대화하기 때문에, 우리가 어떻게 HTTP 트래픽이 프락시로 향하는 길을 찾아내는지 설명할 필요가 있다.
<img src="../Image/to direct web requests to proxies.png">

##### 클라이언트를 수정한다
    만일 클라이언트가 프락시를 사용하도록 설정되어 있다면, 클라이언트는 HTTP 요청을 바로 그리고 의도적으로 원 서버가 아닌 프락시로 보낸다.

##### 네트워크를 수정한다
    클라이언트는 알지도 못하고 간섭도 할 수 없는 상태에서, 네트워크 인프라를 가로채서 웹 트래픽을 프락시로 가도록 조정하는 몇 가지 기법이 있다.
    이 가로챔은 일반적으로 HTTP 트래픽을 지켜보고 가로채어 클라이언트 모르게 트래픽을 프락시로 보내는 스위칭 장치와 라우팅 장치를 필요로 한다.
    이것을 인터셉트 프락시라고 부른다.

##### DNS 이름공간을 수정한다
    DNS 이름 테이블을 수동으로 편집하거나 사용할 적절한 프락시나
    서버를 계산해주는 특별한 동적 DNS 서버를 이용해서 조정될 수 있다.

##### 웹 서버를 수정한다
    몇몇 웹 서버는 HTTP 리다이렉션 명령을 클라이언트에게 돌려줌으로써 클라이언트의 요청을 프락시로 리다이렉트 하도록 설정할 수 있다.
    리다이렉트를 받는 즉시 클라이언트는 프락시와의 트랜잭션을 시작한다.