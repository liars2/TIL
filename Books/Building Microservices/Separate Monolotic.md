모노리식 서비스 분리하기
=========================

    모놀로식은 마이크로서비스와 달리 강한 결합성, 낮은 응집력을 가지고 있는건 잘 알고 있다.
    근데, 왜? 꼭 모놀리식을 마이크로서비스로 바꿔야 하는가?

모놀리식 서비스를 마이크로서비스로 바꾸었을 때의 장점
-----------------------------------------------------

1. 변경의 속도
    - 배포하는데 속도 제한이 걸리지 않는다.
2. 팀 분활
    - 한가지 모놀리식 서비스의 개발이 아닌 마이크로서비스 단위로 개발을 할 수 있다.
3. 기술의 이기종성
    - 한가지 언어로 구현되있는게 아닌 서비스에 맞는 언어를 선택해서 구현할 수 있다! (서비스 지향 아키텍쳐)
4. DB 분리
    - 이후 밑에서 다룰 예정이다.
5. 보안
    - 각 각의 서비스 마다 접근 할 수 있는 리소스가 다르니, 보안적 측면에서도 좋다.

> 사용하고 있는 비지니스에 위 장점들이 **필요하다고 판단한다면,** 마이크로서비스로 바꾸는것이 더 효율적이다.

모놀리식 서비스의 접합부
---------------------------

보통 접합부라고 생각을 한다면 코드베이스에서 각각의 서비스를 잇는 부분이라고 생각할 수 있는데

모놀리식 서비스의 접합부는 이 접합부를 지워도 나머지 모놀리식 서비스에서는 영향이 없는 부분이다.

> 그럼 가장 좋은 접합부를 추상적인 개념으로 묶는다면 어떤 기준이 좋을까?

앞서 배운 BC(Bounded Context)가 좋은 접합부라고 볼 수 있다. 아예 경계선으로 나눈 도메인들의 집합이니까.

공예
---------

모놀리식은 대리석 공예로 비교해도 손색없을 정도로 공예를 하면서 지켜야 할 원칙들이 비슷하다

목적을 비유해보면 이와 같이 성립할 수 있다.

> 큰 대리석(모놀리식)을 깍아서(분리) 조각상(마이크로서비스)로 만드는 것이니까.

또 이런 원칙도 같다.

> 한 번에 모든것을 깍으려고 하지 않고 (Big Bang, 점진적 접근법)
> 머리, 몸통, 다리 한 부위마다 (DB Schema, Packaging..)
> 하나씩 차근 차근 (CodeBase 수정 -> DB Separate..)

모놀리식 분리순서
=====================

    모놀리식 서비스를 마이크로서비스로 바꾸는 단위를 나누자면,
    코드베이스와 데이터베이스로 분리 순서가 나뉘어 진다.

코드베이스
----------

1. 콘텍스트 대표하는 패키지를 구성한다

2. 대표 패키지로 **접합부를 기준으로 한** 기존 코드를 이동시킨다.

3. 코드 이동 도중에 발생하는 의존성을 분석한 후 대응한다.

데이터베이스
----------

1. 데이터베이스에 읽고 쓰는 코드 부분을 나눔

2. 객체 혹은 데이터 구조를 매핑하기 쉽게 분활 분할

3. 데이터베이스 리팩토링

데이터베이스 분할 작업중 발생하는 문제점들
------------------------------------------

### 외부 키 관계

    외래키로 다른 DB를 접근한다면, 이 서비스는 어떻게 바꿀 수 있을까?

1. 외래키로 접근하는 해당 코드를 지운다.
2. 해당 정보를 가져올 수 있는 API를 만든다.

이렇게 API를 사용하여 서로 분리된 DB와 네트워크 호출로 데이터를 처리한다면, 우리가 원하는 느슨한 결합성을 기대할 수 있다.

### 공유 정적 데이터

    어떤 정적 테이블을(ex. 국가코드) 모든 서비스가 공유하여 높은 결합성을 초래하는 경우가 있다.
    그런 테이블은 다음과 같은 방법으로 분해를 한다.

1. Ctrl C+D
    - 정적 테이블을 사용하는 서비스 마다 따로 복제하여 붙여넣는다.
    </br>만약 테이블 중 하나에 데이터가 추가된다면 나머지 테이블도 추가하여야 하는 번거로움과 위험성(잊고 추가를 안했을 시에)이 일어난다.

2. 열거형 데이터화



### 공유 데이터

### 공유 테이블